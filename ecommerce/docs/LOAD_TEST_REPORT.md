# λ¶€ν• ν…μ¤νΈ λ³΄κ³ μ„

> **ν…μ¤νΈ μΌμ‹**: 2025-12-26
> **ν…μ¤νΈ λ„κµ¬**: Grafana k6
> **ν…μ¤νΈ ν™κ²½**: Docker (AWS t4g.micro/small μ¤ν™ μ‹λ®¬λ μ΄μ…)

---

## 1. ν…μ¤νΈ λ€μƒ μ„ μ •

### 1.1 μ„ μ • κΈ°μ¤€

μ΄μ»¤λ¨Έμ¤ μ‹μ¤ν…μ—μ„ **μ¥μ•  λ°μƒ μ‹ λΉ„μ¦λ‹μ¤ μν–¥λ„κ°€ ν° API**λ¥Ό μ°μ„  μ„ μ •ν–μµλ‹λ‹¤.

| μ„ μ • κΈ°μ¤€ | μ„¤λ… |
|----------|------|
| λ™μ‹μ„± κ²½ν•© | λ¶„μ‚°λ½, DB λ½ λ“± λ¦¬μ†μ¤ κ²½ν•©μ΄ λ°μƒν•λ” API |
| λ°μ΄ν„° μ •ν•©μ„± | μ¬κ³ , μΏ ν° μλ‰ λ“± μ •ν™•μ„±μ΄ μ¤‘μ”ν• API |
| νΈλν”½ μ§‘μ¤‘ | μ΄λ²¤νΈ μ‹ μ¤νμ΄ν¬ νΈλν”½μ΄ μμƒλλ” API |
| μ™Έλ¶€ μμ΅΄μ„± | Kafka, Redis λ“± μ™Έλ¶€ μ‹μ¤ν… μ—°λ™ API |

### 1.2 ν…μ¤νΈ λ€μƒ API λ° μ„ν—λ„

| μ°μ„ μμ„ | API | μ„ν—λ„ | μ„ν— μ”μΈ |
|:-------:|-----|:------:|----------|
| 1 | μΏ ν° λ°κΈ‰ | π”΄ Critical | Redis SADD κ²½ν•©, λ¶„μ‚°λ½, μλ‰ μ ν• |
| 2 | μ²΄ν¬μ•„μ›ƒ (μ¬κ³  μμ•½) | π”΄ Critical | DB λΉ„κ΄€μ  λ½, μ¬κ³  μ •ν•©μ„± |
| 3 | κ²°μ  μ²λ¦¬ | π”΄ Critical | ν¬μΈνΈ λ¶„μ‚°λ½, Kafka μ΄λ²¤νΈ, νΈλμ­μ… |
| 4 | μΈκΈ°μƒν’/λ­ν‚Ή μ΅°ν | π  High | μΊμ‹ μ¤νƒ¬ν”Όλ“, DB μ»¤λ„¥μ… ν’€ κ³ κ° |
| 5 | μƒν’ μƒμ„Έ μ΅°ν | π΅ Medium | μ΅°νμ μ¦κ°€(Redis), λ†’μ€ νΈλν”½ |
| 6 | μƒν’ λ©λ΅ μ΅°ν | πΆ Low | μ½κΈ° μ „μ©, μΊμ‹ κ°€λ¥ |

---

## 2. ν…μ¤νΈ λ©μ 

### 2.1 κ²€μ¦ λ©ν‘

| λ©μ  | μ„¤λ… | μΈ΅μ • μ§€ν‘ |
|------|------|----------|
| **μΈν”„λΌ ν•κ³„ νμ•…** | t4g.micro μ¤ν™μ—μ„ μ²λ¦¬ κ°€λ¥ν• μµλ€ λ¶€ν• ν™•μΈ | TPS, μ—λ¬μ¨ |
| **λ³‘λ© μ§€μ  μ‹λ³„** | App/DB/Redis/Kafka μ¤‘ λ³‘λ© λ°μƒ μ§€μ  ν™•μΈ | μ‘λ‹µμ‹κ°„, λ¦¬μ†μ¤ μ‚¬μ©λ¥  |
| **λ™μ‹μ„± μ μ–΄ κ²€μ¦** | λ¶„μ‚°λ½, DB λ½μ μ •μƒ λ™μ‘ ν™•μΈ | μ¤λ²„μ…€λ§ λ°μƒ μ—¬λ¶€ |
| **μ¥μ•  λ³µμ›λ ¥ ν™•μΈ** | κ³Όλ¶€ν• μƒν™©μ—μ„μ μ‹μ¤ν… μ•μ •μ„± ν™•μΈ | μ—λ¬ λ³µκµ¬, νƒ€μ„μ•„μ›ƒ |

### 2.2 SLA λ©ν‘

| μ§€ν‘ | μµμ† λ©ν‘ | κ¶μ¥ λ©ν‘ | λΉ„κ³  |
|-----|:--------:|:--------:|------|
| TPS | 20 | 50 | λ™μ‹ μ ‘μ† κΈ°μ¤€ |
| p95 μ‘λ‹µμ‹κ°„ | < 2,000ms | < 1,000ms | μ‚¬μ©μ μ²΄κ° ν’μ§ |
| μ—λ¬μ¨ | < 10% | < 5% | λΉ„μ¦λ‹μ¤ λ΅μ§ μ—λ¬ μ μ™Έ |

---

## 3. ν…μ¤νΈ ν™κ²½

### 3.1 μΈν”„λΌ κµ¬μ„±
- μ μ • μΈν”„λΌ μ¤ν™μ„ μ„ν• μµμ† μ¤ν™ μ°μ„  μ μ©

```mermaid
flowchart TB
    subgraph LoadGen["Load Generator"]
        K6[k6<br/>100~500 VUs]
    end

    subgraph App["Application Server"]
        Spring[Spring Boot + Kotlin<br/>Host Machine]
    end

    subgraph Infra["Infrastructure (Docker)"]
        MySQL[(MySQL<br/>1GB<br/>db.t4g.micro)]
        Redis[(Redis<br/>1GB<br/>t4g.micro)]
        Kafka[Kafka<br/>2GB<br/>t4g.small]
    end

    K6 -->|HTTP| Spring
    Spring --> MySQL
    Spring --> Redis
    Spring --> Kafka
```

### 3.2 λ¦¬μ†μ¤ μ ν• (AWS Terraform μ¤ν™ λ™μΌ)

| μ»΄ν¬λ„νΈ | CPU | Memory | μ‹λ®¬λ μ΄μ… μΈμ¤ν„΄μ¤ |
|---------|:---:|:------:|-------------------|
| MySQL | 2 vCPU | 1GB | db.t4g.micro |
| Redis | 2 vCPU | 1GB | t4g.micro |
| Kafka | 2 vCPU | 2GB | t4g.small |

---

## 4. ν…μ¤νΈ μ‹λ‚λ¦¬μ¤

4κ°€μ§€ μ¥μ•  μ‹λ‚λ¦¬μ¤λ¥Ό μ„¤κ³„ν•μ—¬ μ‹μ¤ν…μ μ·¨μ•½μ μ„ κ²€μ¦ν–μµλ‹λ‹¤.

### 4.1 μ‹λ‚λ¦¬μ¤ κ°μ”

| # | μ‹λ‚λ¦¬μ¤ | νμΌλ… | VUs | λ©μ  |
|:-:|---------|--------|:---:|------|
| 1 | μΏ ν° μ„ μ°©μ μ΄λ²¤νΈ | `stress-coupon-rush.js` | 100 | λ™μ‹μ„± κ²½ν•©, μ¤‘λ³µ λ°κΈ‰ λ°©μ§€ |
| 2 | μ¬κ³  λ™μ‹ μ£Όλ¬Έ | `stress-inventory-contention.js` | 100 | μ¤λ²„μ…€λ§ λ°©μ§€, λ½ κ²½ν•© |
| 3 | μΊμ‹ μ¤νƒ¬ν”Όλ“ | `stress-cache-stampede.js` | 100 | Thundering Herd, DB λ³΄νΈ |
| 4 | κ²°μ  ν­μ£Ό | `stress-payment-burst.js` | 100 | ν¬μΈνΈ μ •ν•©μ„±, Kafka λ¶€ν• |
| 5 | λΈ”λ™ν”„λΌμ΄λ°μ΄ | `stress-event-simulation.js` | 500 | λ³µν•© μ΄λ²¤νΈ, μ¤ν™ ν•κ³„ ν™•μΈ |

---

### 4.2 μ‹λ‚λ¦¬μ¤ 1: μΏ ν° μ„ μ°©μ μ΄λ²¤νΈ

#### μƒν™© μ„¤μ •
> μ΄λ²¤νΈ μ¤ν” μ‹κ°μ— 500λ…μ΄ λ™μ‹μ— μ„ μ°©μ 100κ° ν•μ • μΏ ν° λ°κΈ‰ μ‹λ„

#### λ¶€ν• ν¨ν„΄

```mermaid
xychart-beta
    title "μΏ ν° μ„ μ°©μ - VUs λ³€ν™”"
    x-axis ["0s", "5s", "35s", "1m35s", "2m5s", "2m15s"]
    y-axis "VUs" 0 --> 600
    line [0, 300, 500, 500, 300, 0]
```

#### μμƒ μ¥μ•  μ§€μ 

```mermaid
flowchart LR
    A[500 VUs λ™μ‹ μ”μ²­] --> B{λ¶„μ‚°λ½ νλ“}
    B -->|μ„±κ³µ| C[μΏ ν° λ°κΈ‰]
    B -->|μ‹¤ν¨| D[νƒ€μ„μ•„μ›ƒ]
    B -->|λ€κΈ°| E[Redis SADD κ²½ν•©]
    E --> F[DB μ»¤λ„¥μ… ν’€ κ³ κ°]
```

---

### 4.3 μ‹λ‚λ¦¬μ¤ 2: μ¬κ³  λ™μ‹ μ£Όλ¬Έ (ν•μ •ν μ¶μ‹)

#### μƒν™© μ„¤μ •
> μ¬κ³  10κ°μΈ ν•μ •ν μƒν’ 5μΆ…μ— 300λ…μ΄ λ™μ‹ μ£Όλ¬Έ μ‹λ„
> μ²΄ν¬μ•„μ›ƒ β†’ κ²°μ  β†’ μ£Όλ¬Έ μ™„λ£ μ „μ²΄ ν”λ΅μ° ν…μ¤νΈ

#### λ¶€ν• ν¨ν„΄

```mermaid
xychart-beta
    title "μ¬κ³  λ™μ‹ μ£Όλ¬Έ - VUs λ³€ν™”"
    x-axis ["0s", "10s", "40s", "1m40s", "2m10s", "2m30s"]
    y-axis "VUs" 0 --> 350
    line [0, 100, 200, 300, 100, 0]
```

#### μμƒ μ¥μ•  μ§€μ 

```mermaid
flowchart TD
    A[300 VUs λ™μ‹ μ£Όλ¬Έ] --> B[μ²΄ν¬μ•„μ›ƒ]
    B --> C{μ¬κ³  ν™•μΈ}
    C -->|μ¬κ³  μμ| D[DB λΉ„κ΄€μ  λ½]
    C -->|μ¬κ³  μ—†μ| E[μ£Όλ¬Έ μ‹¤ν¨]
    D --> F{λ½ νλ“}
    F -->|μ„±κ³µ| G[μ¬κ³  μμ•½]
    F -->|μ‹¤ν¨| H[λ¶„μ‚°λ½ νƒ€μ„μ•„μ›ƒ]
    G --> I[κ²°μ  μ§„ν–‰]
    I --> J{μ¤λ²„μ…€λ§?}
    J -->|λ°μƒ| K[π”΄ λ™μ‹μ„± μ μ–΄ μ‹¤ν¨]
    J -->|μ—†μ| L[β… μ •μƒ]
```

---

### 4.4 μ‹λ‚λ¦¬μ¤ 3: μΊμ‹ μ¤νƒ¬ν”Όλ“

#### μƒν™© μ„¤μ •
> μΊμ‹ λ§λ£/λ―Έμ¤ μƒνƒμ—μ„ 400λ…μ΄ λ™μ‹μ— μΈκΈ°μƒν’/λ­ν‚Ή μ΅°ν
> Thundering Herd λ¬Έμ  μ‹λ®¬λ μ΄μ…

#### λ¶€ν• ν¨ν„΄

```mermaid
xychart-beta
    title "μΊμ‹ μ¤νƒ¬ν”Όλ“ - VUs λ³€ν™”"
    x-axis ["0s", "5s", "15s", "1m15s", "1m45s", "2m"]
    y-axis "VUs" 0 --> 500
    line [0, 200, 400, 400, 200, 0]
```

#### μμƒ μ¥μ•  μ§€μ 

```mermaid
flowchart TD
    A[400 VUs λ™μ‹ μ΅°ν] --> B{μΊμ‹ ν™•μΈ}
    B -->|Hit| C[β… Redis μ‘λ‹µ]
    B -->|Miss| D[DB μ΅°ν]
    D --> E[λ¨λ“  μ”μ²­μ΄ DBλ΅]
    E --> F[DB μ»¤λ„¥μ… ν’€ κ³ κ°]
    E --> G[Redis μ—°κ²° ν’€ κ³ κ°]
    F --> H[π”΄ Thundering Herd]
    G --> H
```

---

### 4.5 μ‹λ‚λ¦¬μ¤ 4: κ²°μ  ν­μ£Ό

#### μƒν™© μ„¤μ •
> νƒ€μ„μ„ΈμΌ μΆ…λ£ μ§μ „ 200λ…μ΄ λ™μ‹ κ²°μ  μ²λ¦¬ μ”μ²­
> ν¬μΈνΈ μ°¨κ° + Kafka μ΄λ²¤νΈ λ°ν–‰ λ¶€ν•

#### λ¶€ν• ν¨ν„΄

```mermaid
xychart-beta
    title "κ²°μ  ν­μ£Ό - VUs λ³€ν™”"
    x-axis ["0s", "10s", "30s", "1m30s", "2m"]
    y-axis "VUs" 0 --> 250
    line [0, 50, 150, 200, 0]
```

#### μμƒ μ¥μ•  μ§€μ 

```mermaid
flowchart TD
    A[200 VUs λ™μ‹ κ²°μ ] --> B[μ²΄ν¬μ•„μ›ƒ]
    B --> C[κ²°μ  μ”μ²­]
    C --> D{ν¬μΈνΈ λ¶„μ‚°λ½}
    D -->|νλ“| E[ν¬μΈνΈ μ°¨κ°]
    D -->|λ€κΈ°| F[λ½ νƒ€μ„μ•„μ›ƒ 120s]
    E --> G[Kafka μ΄λ²¤νΈ λ°ν–‰]
    G -->|μ„±κ³µ| H[μ£Όλ¬Έ μ™„λ£]
    G -->|μ‹¤ν¨| I[π”΄ μƒνƒ λ¶μΌμΉ]
    F --> J[π”΄ κ²°μ  μ§€μ—°]
```

---

## 5. ν…μ¤νΈ κ²°κ³Ό μ”μ•½

> μƒμ„Έ μ¥μ•  λ¶„μ„ λ° κ°μ„  λ‚΄μ—­μ€ [INCIDENT_REPORT.md](./INCIDENT_REPORT.md) μ°Έμ΅°

### 5.1 μµμΆ… μ„±λ¥ μ§€ν‘ (100 VUs, 30μ΄)

| μ‹λ‚λ¦¬μ¤ | μ΄ μ”μ²­ | p95 μ‘λ‹µ | μ„±κ³µλ¥  | SLA |
|---------|-------:|--------:|------:|:---:|
| μΏ ν° μ„ μ°©μ | 50,771 | **35ms** | 100%* | β… |
| μ¬κ³  λ™μ‹ μ£Όλ¬Έ | 11,893 | **304ms** | 100% | β… |
| μΊμ‹ μ¤νƒ¬ν”Όλ“ | 98,634 | **7ms** | 100% | β… |

> *μ¤‘λ³µ λ°κΈ‰ κ±°λ¶€(409)λ” μ •μƒ λ™μ‘μΌλ΅ μ„±κ³µ μ²λ¦¬

### 5.2 λΈ”λ™ν”„λΌμ΄λ°μ΄ μ‹λ®¬λ μ΄μ… (500 VUs, 3λ¶„ 50μ΄)

| μ§€ν‘ | κ²°κ³Ό | νμ • |
|------|------|:----:|
| μ΄ μ”μ²­ | 56,148 | - |
| μ„±κ³µλ¥  | 99.4% | β οΈ |
| μ²΄ν¬μ•„μ›ƒ p95 | 2,933ms | β οΈ |
| 5xx μ—λ¬ | 224κ±΄ | β οΈ |

**5xx μ—λ¬ μ›μΈ**: Outbox μ΄λ²¤νΈ μ²λ¦¬ μ§€μ—°μΌλ΅ μΈν• μ£Όλ¬Έ μƒνƒ λ¶μΌμΉ
- μΈν”„λΌ λ¦¬μ†μ¤λ” μ¶©λ¶„ (MySQL 60%, Redis 4%, Kafka 29%)

### 5.3 μΈν”„λΌ μ¤ν™ κ²€μ¦ κ²°κ³Ό

| μ»΄ν¬λ„νΈ | μ¤ν™ | λ™μ‹ 100 VUs | νμ • |
|---------|------|-------------|:----:|
| MySQL | 1GB (db.t4g.micro) | μ•μ • | β… |
| Redis | 1GB (t4g.micro) | μ•μ • | β… |
| Kafka | 2GB (t4g.small) | μ•μ • | β… |

### 5.4 SLA μ¶©μ΅± μ—¬λ¶€

| μ§€ν‘ | λ©ν‘ | κ²°κ³Ό | νμ • |
|------|:----:|:----:|:----:|
| μΏ ν° λ°κΈ‰ p95 | < 2,000ms | **35ms** | β… λ‹¬μ„± |
| μ²΄ν¬μ•„μ›ƒ p95 | < 2,000ms | **304ms** | β… λ‹¬μ„± |
| μ „μ²΄ ν”λ΅μ° p95 | < 2,000ms | **408ms** | β… λ‹¬μ„± |
| κ²°μ  μ„±κ³µλ¥  | > 95% | **100%** | β… λ‹¬μ„± |
| μΊμ‹ ννΈμ¨ | > 80% | **100%** | β… λ‹¬μ„± |
| μ„λ²„ μ—λ¬μ¨ (100 VUs) | < 10% | **0%** | β… λ‹¬μ„± |

---

## 6. μΈν”„λΌ μ¤ν™ μ •λ‹Ήμ„±

### 6.1 μµμ† μ¤ν™ μ„ μ • κ·Όκ±°

```mermaid
flowchart TB
    subgraph Target["λ©ν‘ νΈλν”½"]
        VU[λ™μ‹ μ‚¬μ©μ 100λ…<br/>μ΄κΈ° μ„λΉ„μ¤ κ·λ¨]
    end

    subgraph Spec["μµμ† μΈν”„λΌ μ¤ν™"]
        MySQL[(MySQL<br/>db.t4g.micro<br/>1GB)]
        Redis[(Redis<br/>t4g.micro<br/>1GB)]
        Kafka[Kafka<br/>t4g.small<br/>2GB]
    end

    subgraph Result["κ²€μ¦ κ²°κ³Ό"]
        P95[p95 < 500ms]
        Success[μ„±κ³µλ¥  100%]
        Stable[μ•μ • μ΄μ]
    end

    VU --> Spec
    Spec --> Result
```

### 6.2 μ¤ν™λ³„ μ„ μ • μ΄μ 

| μ»΄ν¬λ„νΈ | μ¤ν™ | μ„ μ • μ΄μ  | κ²€μ¦ κ²°κ³Ό |
|---------|------|----------|----------|
| **MySQL** | db.t4g.micro (1GB) | μ»¤λ„¥μ… ν’€ 10κ°λ΅ λ™μ‹ 100 VUs μ²λ¦¬ κ°€λ¥, PESSIMISTIC_FORCE_INCREMENTλ΅ λ½ ν¨μ¨ν™” | p95 304ms λ‹¬μ„± |
| **Redis** | t4g.micro (1GB) | μΊμ‹ + λ¶„μ‚°λ½ μ©λ„, λ©”λ¨λ¦¬ μ‚¬μ©λ¥  4% λ―Έλ§ | μΊμ‹ ννΈμ¨ 100% |
| **Kafka** | t4g.small (2GB) | μ΄λ²¤νΈ μ†μ‹± + Outbox ν¨ν„΄, λΈλ΅μ»¤ 1λ€λ΅ μ¶©λ¶„ | μ§€μ—° μ—†μ |

### 6.3 λΉ„μ© ν¨μ¨μ„±

| κµ¬μ„± | μ›” μμƒ λΉ„μ© (μ„μΈ λ¦¬μ „) |
|------|----------------------:|
| db.t4g.micro | ~$12 |
| t4g.micro Γ— 2 (Redis, App) | ~$16 |
| t4g.small (Kafka) | ~$12 |
| **ν•©κ³„** | **~$40/μ›”** |

> μ΄κΈ° μ„λΉ„μ¤ MVPμ— μ ν•©ν• λΉ„μ© κµ¬μ΅°

---

## 7. κ²°λ΅ 

### 7.1 μΈν”„λΌ μ¤ν™ κ²€μ¦ κ²°κ³Ό

```mermaid
quadrantChart
    title μ¤ν™ μ μ •μ„± ν‰κ°€
    x-axis λ‚®μ€ λΉ„μ© --> λ†’μ€ λΉ„μ©
    y-axis λ‚®μ€ μ„±λ¥ --> λ†’μ€ μ„±λ¥
    quadrant-1 "κ³Όν¬μ"
    quadrant-2 "μµμ "
    quadrant-3 "λ¶€μ΅±"
    quadrant-4 "μ μ •"
    "ν„μ¬ μ¤ν™": [0.25, 0.75]
```

### 7.2 μµμΆ… νμ •

| ν•­λ© | νμ • | λΉ„κ³  |
|------|:----:|------|
| λ™μ‹ 100 VUs μ²λ¦¬ | β… **μ ν•©** | p95 < 500ms |
| λ™μ‹μ„± μ μ–΄ | β… **μ ν•©** | μ¤λ²„μ…€λ§ 0κ±΄ |
| λΉ„μ© ν¨μ¨μ„± | β… **μ ν•©** | ~$40/μ›” |
| ν™•μ¥μ„± | β… **μ ν•©** | μμ§ ν™•μ¥ μ—¬μ  μμ |

**μµμΆ… νμ •: β… μµμ† μΈν”„λΌ μ¤ν™μΌλ΅ μ ν•©**

- λ™μ‹ 100λ… κΈ°μ¤€ λ¨λ“  SLA μ¶©μ΅±
- μ΄κΈ° μ„λΉ„μ¤ λλ” MVP λ‹¨κ³„μ— μ ν•©
- νΈλν”½ μ¦κ°€ μ‹ t4g.small β†’ t4g.medium μμ°¨ ν™•μ¥ κ¶μ¥

---

## 8. ν™•μ¥ μ „λµ

νΈλν”½ μ¦κ°€ μ‹ λ‹¨κ³„λ³„ ν™•μ¥ κ³„ν:

| λ‹¨κ³„ | λ™μ‹ μ‚¬μ©μ | MySQL | Redis | Kafka | μμƒ λΉ„μ© |
|:---:|:---------:|-------|-------|-------|--------:|
| ν„μ¬ | 100 | db.t4g.micro | t4g.micro | t4g.small | $40/μ›” |
| 1λ‹¨κ³„ | 300 | db.t4g.small | t4g.small | t4g.small | $80/μ›” |
| 2λ‹¨κ³„ | 1,000 | db.t4g.medium | t4g.medium | t4g.medium | $150/μ›” |
| 3λ‹¨κ³„ | 5,000+ | RDS Multi-AZ | ElastiCache | MSK | $500+/μ›” |

---

## μ°Έκ³ μλ£

- [Grafana k6 Documentation](https://k6.io/docs/)
- [AWS μΈμ¤ν„΄μ¤ νƒ€μ…](https://aws.amazon.com/ec2/instance-types/)